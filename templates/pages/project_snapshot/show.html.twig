{% extends 'content.html.twig' %}

{% block title %}Project {{ project_snapshot.project.name }} snapshot | {{ parent() }}{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-10">
            <h1>Project snapshot</h1>
        </div>
        <div class="col-2">
            {{ include('pages/project_snapshot/_delete_form.html.twig') }}
        </div>
    </div>

    {{ breadcrumbs(project_snapshot)|raw }}

    {% include 'components/flash-messages.html.twig' %}

    <table class="table">
        <tbody>
            <tr>
                <th>Timestamp</th>
                <td>{{ project_snapshot.timestamp|date(datetime_format()) }}</td>
            </tr>
        </tbody>
    </table>

    <table class="table table-striped">
        <thead>
        <tr>
            <th>Image</th>
            <th>Page snapshot</th>
            <th>Page</th>
            <th>HTTP Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for resource_snapshot in project_snapshot.snapshots %}
            <tr>
                <td>
                    {% if resource_snapshot.image is defined %}

                        <a target="_blank" class="cursor-zoom-in" href="{{ asset(resource_snapshot.image) }}">
                            <img width="200px" alt="{{ resource_snapshot.timestamp|date(datetime_format()) }} snapshot"
                                 src="{{ asset(resource_snapshot.image) }}">
                        </a>

                    {% endif %}
                </td>
                <td>
                    <a href="{{ path('resource_snapshot_show', {'project': project_snapshot.project.id, 'resource': resource_snapshot.resource.id, 'snapshot': resource_snapshot.id}) }}">{{ resource_snapshot.timestamp|date(datetime_format()) }}</a>
                </td>
                <td>
                    <a href="{{ path('resource_show', {'project': project_snapshot.project.id, 'resource': resource_snapshot.resource.id} ) }}">{% if resource_snapshot.resource.name is not empty %}{{ resource_snapshot.resource.name }}{% else %}{{ resource_snapshot.resource.path }}{% endif %}</a>
                </td>
                <td>{% include 'components/response-code.html.twig' with {code: resource_snapshot.status} only %}</td>
                <td>
                    <a data-toggle="tooltip"
                       data-placement="bottom"
                       title="Visit page"
                       target="_blank"
                       href="{{ resource_snapshot.resource.url }}">
                        <i class="fa fa-external-link-alt"></i>
                    </a>
                    <a data-toggle="tooltip"
                       data-placement="bottom"
                       title="Show code"
                       target="_blank"
                       href="{{ path('editor', {'snapshot1': resource_snapshot.id}) }}">
                        <i class="fa fa-file-code"></i>
                    </a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4" class="text-center">No page screenshots here.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}
